<div class="highlight"><pre><span class="no">O_EVTONLY</span> <span class="o">=</span> <span class="mh">0x8000</span>
<span class="n">queue</span> <span class="o">=</span> <span class="ss">Dispatch</span><span class="p">:</span><span class="ss">:Queue</span><span class="o">.</span><span class="n">new</span> <span class="s1">&#39;example.vnode&#39;</span>
<span class="n">type</span>  <span class="o">=</span> <span class="ss">Dispatch</span><span class="p">:</span><span class="ss">:Source</span><span class="o">::</span><span class="no">VNODE</span>
<span class="n">opts</span>  <span class="o">=</span> <span class="ss">Dispatch</span><span class="p">:</span><span class="ss">:Source</span><span class="o">::</span><span class="no">VNODE_WRITE</span> <span class="o">|</span> <span class="ss">Dispatch</span><span class="p">:</span><span class="ss">:Source</span><span class="o">::</span><span class="no">VNODE_DELETE</span>
<span class="n">dirPath</span> <span class="o">=</span> <span class="s1">&#39;/Desktion/dir&#39;</span>
<span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="no">O_EVTONLY</span><span class="p">)</span>
<span class="ss">Dispatch</span><span class="p">:</span><span class="ss">:Source</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">dirPath</span><span class="p">,</span> <span class="n">opts</span><span class="p">,</span> <span class="n">queue</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">src</span><span class="o">|</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">data</span>
  <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="ss">Dispatch</span><span class="p">:</span><span class="ss">:Source</span><span class="o">::</span><span class="no">VNODE_WRITE</span>
    <span class="nb">puts</span> <span class="s2">&quot;changed directory data&quot;</span>
  <span class="k">elsif</span> <span class="n">data</span> <span class="o">==</span> <span class="ss">Dispatch</span><span class="p">:</span><span class="ss">:Source</span><span class="o">::</span><span class="no">VNODE_DELETE</span>
    <span class="nb">puts</span> <span class="s1">&#39;The directory has been deleted.&#39;</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>